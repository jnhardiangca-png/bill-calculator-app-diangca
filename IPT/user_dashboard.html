<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Dashboard</title>
    <link rel="stylesheet" href="CSS/user_dashboard.css">
</head>

<body>

    <!-- Navigation Bar -->
    <nav>
        <ul>
            <li><a href="index.html">Home</a></li>
            <li><a class="active" href="user_dashboard.html">Dashboard</a></li>
            <li><a href="calculator_page.html">Calculator</a></li>
            <li><a href="result.html">Results</a></li>
            <li><a href="profile_page.html">Profile</a></li>
            <li><a href="#" onclick="handleLogout(); return false;">Logout</a></li>
        </ul>
    </nav>

    <!-- MAIN CONTENT -->
    <div class="container">
        <h1>User Dashboard</h1>
        <p class="welcome-text">Welcome back! Manage your electricity bill calculations.</p>

        <div class="dashboard-links">

            <a href="calculator_page.html" class="dashboard-card">
                <div class="card-icon"></div>
                <h3>Calculate Bill</h3>
                <p>Compute your electricity bill easily</p>
            </a>

            <a href="results_page.html" class="dashboard-card">
                <div class="card-icon"></div>
                <h3>View Results</h3>
                <p>Check your previous calculations</p>
            </a>

            <a href="profile_page.html" class="dashboard-card">
                <div class="card-icon"></div>
                <h3>Your Profile</h3>
                <p>Update personal information</p>
            </a>

        </div>
    </div>

    <!-- Supabase -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="js/supabase-config.js"></script>
    <script src="js/auth.js"></script>

    <script>
        document.addEventListener("DOMContentLoaded", async () => {
            const session = await initAuth();
            if (session) {
                const user = await getCurrentUser();
                if (user) {
                    const welcomeText = document.querySelector(".welcome-text");
                    const name = user.user_metadata?.full_name || user.email;
                    welcomeText.textContent = `Welcome back, ${name}! Manage your electricity bill calculations.`;
                }
            }
        });

        async function handleLogout() {
            const success = await signOut();
            if (success) window.location.href = "login.html";
            else alert("Error logging out. Please try again.");
        }
    </script>

</body>
</html>
